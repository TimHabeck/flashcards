DATA WAREHOUSING
Kapitel 4: ETL: Datenvorverarbeitung und integration
Victor Christen
christen@informatik.uni-leipzig.de
UniversitÃ¤t Leipzig
Institut fÃ¼r Informatik
Abteilung Datenbanken

AGENDA
ï€­ ETL-Ãœberblick
ï€­ Schemaintegration
ï€­ Bottom-Up- vs. Top-Down-Integration
ï€­ Semantische HeterogenitÃ¤t

ï€­ Schema Matching
ï€­ Verfahren
ï€­ Prototypen / Tools

ï€­ Data Cleaning
ï€­ Probleme
ï€­ Teilaufgaben

ï€­ Entity Matching (record linkage)
ï€­ Blocking, Matching, Clustering
ï€­ Systeme/Prototypen: MS SQL-Server, Dedoop, Famer
Abteilung Datenbanken

DATA WAREHOUSING

4-2

ETL-PROZESS
ï€­ Data Warehousing und ETL: materialisierter Ansatz zur
Datenintegration
ï€­ Erzeugung einer aggregierten, materialisierten Datenquelle fÃ¼r OnlineAnalysen
ï€­ komplexer, aufwÃ¤ndiger Integrationsprozess
ï€­ Offline-DurchfÃ¼hrung erlaubt hÃ¶here DatenqualitÃ¤t gegenÃ¼ber virtueller
Datenintegration (Datentransformation wÃ¤hrend Query-Verarbeitung)

ï€­ Extraktion: Selektion eines Ausschnitts der Daten aus Quellen
ï€­ ausgefÃ¼hrt an den entsprechenden Quellen

ï€­ Transformation: Aufbereitung und Anpassung der Daten an
vorgegebene Schema- und QualitÃ¤tsanforderungen
ï€­ ausgefÃ¼hrt im temporÃ¤ren Arbeitsbereich (Data Staging Area)

ï€­ Laden: physisches Einbringen der Daten aus Arbeitsbereich in das
Data Warehouse, einschlieÃŸlich evtl. notwendiger Aggregationen

Abteilung Datenbanken

DATA WAREHOUSING

4-3

ETL-PROZESS (2)
ï€­ aufwÃ¤ndigster Teil des Data Warehousing
ï€­ Vielzahl von operativen Quellen
ï€­ HeterogenitÃ¤t der Datenquellen (DBMS, Schemata, Daten)
ï€­ GewÃ¤hrleistung hoher QualitÃ¤t der Warehouse-Daten

ï€­ entscheidende Rolle im Data Warehousing, da groÃŸer
Einfluss auf
ï€­ Genauigkeit und Richtigkeit der spÃ¤ter durchgefÃ¼hrten Analysen
ï€­ die darauf basierenden Entscheidungen: â€Garbage In, Garbage
Outâ€œ

Abteilung Datenbanken

DATA WAREHOUSING

4-4

ETL VS ELT VS REVERSE ETL
ï€­ ELT: schnelleres Laden von Daten, v.a. fÃ¼r Data Lake
(Load vor Transform, â€Every Load Transformsâ€œ)

Data
Lake

Serra: Deciphering data architectures, 2024

Abteilung Datenbanken

DATA WAREHOUSING

4-5

ETL ALS INTEGRATIONSPROZESS
ï€­ ETL: Datenintegration auf 2 Ebenen: Schemata und
Instanzdaten
ï€­ Schemaintegration
ï€­ Abbildung von Quellschemata auf Data-Warehouse-Schema:
Schema Matching
ï€­ Adressierung der semantischen HeterogenitÃ¤t (Namenskonflikte,
strukturelle Konflikte)
ï€­ ggf. zunÃ¤chst Anpassung der SchemareprÃ¤senationen (z.B. RM)

ï€­ Datenintegration / Data Cleaning
ï€­ Transformation heterogener Daten in einheitliche, durch Data
Warehouse-Schema vorgeschriebene ReprÃ¤sentation
ï€­ Entdeckung und Behebung von DatenqualitÃ¤tsproblemen
ï€­ Entdeckung Ã¤quivalenter Objekte/SÃ¤tze (Korrespondenzen auf
Instanzenebene): Entity Matching / Duplikatbehandlung
Abteilung Datenbanken

DATA WAREHOUSING

4-6

ETL-PROZESS: ABLAUF
Operational
sources

Data
warehouse

Extraction, Transformation, Loading
Extraction

Integration

Aggregation

Schema extraction
and translation

Schema matching
and integration

Schema
implementation

1

2

3

4

5

Data
warehouse

Data
staging
area
Instance extraction
and transformation

Instance matching
and integration

Filtering,
aggregation

Scheduling, logging, monitoring, recovery, backup
Legends:

Metadata flow

1

3 Instance characteristics
(real metadata)

Data flow

2 Translation rules

4 Mappings between source and target
schema

5 Filtering and aggregation rules

E. Rahm, H. H. Do: Data Cleaning: Problems and Current Approaches. IEEE Techn. Bulletin on Data Engineering, 2000
Abteilung Datenbanken

DATA WAREHOUSING

4-7

SCHEMAINTEGRATION - ANFORDERUNGEN
ï€­ MinimalitÃ¤t
ï€­ keine Redundanz im integrierten Schema
ï€­ Abbildung mehrerer gleicher/Ã¤hnlicher Konzepte in lokalen
Schemata auf ein Konzept im integrierten Schema

ï€­ Korrektheit
ï€­ Ã„quivalenz der im integrierten Schema enthaltenen
Informationen mit denen in den lokalen Schemata
ï€­ Konsistenz der wÃ¤hrend der Integration ergÃ¤nzten Informationen,
z.B. Beziehungen zwischen Konzepten im integrierten Schema

ï€­ VerstÃ¤ndlichkeit
VollstÃ¤ndigkeit (Beibehaltung aller Informationen aus
Quellschemas) ?
Abteilung Datenbanken

DATA WAREHOUSING

4-8

SCHEMAINTEGRATION (2)
ï€­ Probleme der Schemaintegration
ï€­ HeterogenitÃ¤t der SchemareprÃ¤sentationen
ï€­ z.B. relational (SQL), JSON, Dateien ...

ï€­ semantische HeterogenitÃ¤t der Schemaelemente
(Namenskonflikte, strukturelle Konflikte)

ï€­ Alternativen
ï€­ Bottom-Up-Schemaintegration
ï€­ Top-Down-Schemaintegration

Abteilung Datenbanken

DATA WAREHOUSING

4-9

BOTTOM-UP-INTEGRATION (GLOBAL AS VIEW)
ï€­ (vollstÃ¤ndiges) Mischen aller Source-Schemata in
globales Schema
ï€­ setzt Abgleich zwischen Source-Schemas voraus,
insbesondere Bestimmung von Korrespondenzen /
Konflikten
ï€­ globales Schema entspricht gemeinsamer Sicht (View)
auf die zugrundeliegenden Quellen
ï€­ neue Quelle Ã¤ndert meist globales Schema
G

Merge
S1

Abteilung Datenbanken

Match

S2

DATA WAREHOUSING

Sn

4-10

TOP-DOWN-INTEGRATION (LOCAL AS VIEW)
ï€­ globales Schema G ist vorgegeben
ï€­ jede Source S wird unabhÃ¤ngig von anderen Sources mit
globalem Schema abgeglichen, d.h. ein Mapping G - S
erstellt (Mapping beschreibt Inhalt der Quelle)
ï€­ aufwÃ¤ndige Query-Verarbeitung bei virtueller Integration
ï€­ G berÃ¼cksichtigt i.a. nur Teile der lokalen Schemata

G

Match
S1

Abteilung Datenbanken

S2

DATA WAREHOUSING

Sn

4-11

TOP-DOWN-SCHEMAINTEGRATION (2)
lokale Schemata (LS1, LS2, ...)

manuelle Erstellung des
Globalen Schemas GS
(z.B. DW-Schema)

Schematransformation der LS
in einheitliches Modell

einheitliche lokale Schemata

GS

Schema Matching
GS â€“ LS1, GS-LS2 ...

Inter-Schema-Korrespondenzen

Generierung ausfÃ¼hrbarer Mappings
LS1-GS, LS2-GS, ...

Abteilung Datenbanken

DATA WAREHOUSING

4-12

NAMENSKONFLIKTE
Mitarbeiter
Name
Adresse

Angestellte
Name
Anschrift

Firma
Name
Adresse

ï€­ Synonyme: unterschiedliche Namen fÃ¼r das selbe
Konzept
ï€­

Mitarbeiter ï‚» Angestellte
Mitarbeiter.Adresse ï‚» Angestellte.Anschrift

ï€­ Homonyme: gleiche Namen fÃ¼r verschiedene Konzepte
ï€­
(Mitarbeiter.)Name ï‚¹(Firma.)Name
(Mitarbeiter.)Adresse ï‚¹(Firma.)Adresse

ï€­ Hyponyme/Hyperonyme: Unter-/Oberbegriffe

Abteilung Datenbanken

DATA WAREHOUSING

4-13

STRUKTURELLE KONFLIKTE
ï€­ Entity vs. Entity

Arbeiter
PNR
Name
Adresse

ï€­ unterschiedliche SchlÃ¼ssel
PNR - SVNR

ï€­ unterschiedliche Attributmengen,
fehlende Attribute
ï€­ unterschiedliche
Abstraktionsebenen
(Generalisierung, Aggregation)

TeilzeitArbeiter

ï€­ unterschiedliche RealitÃ¤tsauschnitte
(RWS, real world states), Instanzmengen
ï€­
ï€­
ï€­

disjunkt (disjoint):
Person1 â€“Person2

Ã¼berlappend (overlaps):
Person1 â€“Person3, Person2 â€“Person3

enthalten (contains):
Person4 ïƒ Person1, Person4 ïƒ Person3,

Abteilung Datenbanken

DATA WAREHOUSING

VollzeitArbeiter

Angestellte
SVNR
Name
Gehalt
Beruf

MÃ¤nner

Frauen

Person 1
Name
Gehalt
Beruf

Person 2
Name
Gehalt
Beruf

MÃ¤nner

Frauen

Person 3
Name
Gehalt
Beruf

Person 4
Name
Gehalt
Beruf

> 18 Jahre

MÃ¤nner > 18
4-14

STRUKTURELLE KONFLIKTE (2)
ï€­ Attribut vs. Entity-Konflikte
ï€­ ReprÃ¤sentation von Attributen als
eigenstÃ¤ndige Entities/Relationen
ï€­ Bsp.: Produkttyp

ï€­ Attribut vs. Attribut-Konflikte

S2

S1
Produkte
Name
Typ
Preis

CD
Titel
Preis
BÃ¼cher
Titel
Preis

ï€­ unterschiedliche Datentypen
Preis (Float) vs. Preis (String)
ï€­ unterschiedliche Detailgrade
Videospiele
Name vs. Vorname und Nachname
Titel
Preis
ï€­ unterschiedliche Einheiten: $ vs. Euro
ï€­ unterschiedliche Genauigkeiten: Tausend Euro vs. Euro
ï€­ unterschiedliche IntegritÃ¤tsbedingungen, Wertebereiche, Default-Werte
...
Alter >18 vs. Alter > 21
ï€­ unterschiedliche ZulÃ¤ssigkeit von Nullwerten
Abteilung Datenbanken

DATA WAREHOUSING

4-15

AUTOMATISIERUNGSBEDARF
ï€­ bisherige SchemaintegrationsansÃ¤tze weitgehend manuell
ï€­ nutzerdefinierte Korrespondenzen und Konfliktbehandlung
ï€­ Nutzung spezifischen Schema-/Domain-Wissens
ï€­ aufwÃ¤ndig / fehleranfÃ¤llig vor allem fÃ¼r grÃ¶ÃŸere Schemata
ï€­ nicht skalierbar auf viele Schemata
ï€­ hoher Anpassungsaufwand bei SchemaÃ¤nderungen

ï€­ Skalierbarkeit erfordert semi-automatische LÃ¶sungen / Tools!
ï€­ vollautomatische LÃ¶sungen aufgrund semantischer HeterogenitÃ¤t nicht
mÃ¶glich
ï€­ Namensproblematik (Synonyme, Homonyme)
ï€­ begrenzte MÃ¤chtigkeit von Metadaten / Schemasprachen

ï€­ (Teil-)Automatisches Schema-Matching
ï€­ v.a. fÃ¼r groÃŸe Schemata wichtig
ï€­ Nutzer-Feedback notwendig, jedoch im begrenzten Umfang

Abteilung Datenbanken

DATA WAREHOUSING

4-16

4. ETL: DATENVORVERARBEITUNG UND INTEGRATION
ï€­ ETL-Ãœberblick
ï€­ Schemaintegration
ï€­ Bottom-Up- vs. Top-Down-Integration
ï€­ Semantische HeterogenitÃ¤t

ï€­ Schema Matching
ï€­ Verfahren
ï€­ Prototypen / Tools

ï€­ Data Cleaning
ï€­ Probleme
ï€­ Teilaufgaben

ï€­ Entity Matching (record linkage)
ï€­ Blocking, Matching, Clustering
ï€­ Systeme/Prototypen: MS SQL-Server, Dedoop, Famer
Abteilung Datenbanken

DATA WAREHOUSING

4-17

SCHEMA MATCHING
ï€­ kritischer Schritt in zahlreichen Applikationen
ï€­ Datenintegration (u.a. Data Warehouses), Datenaustauch (XML Message
Mapping), Wissensverarbeitung (Ontologie-Matching)

ï€­ Finden semantischer Korrespondenzen zwischen 2 Schemas
ï€­ Input: Schemas und evtl. Instanzbeispiele und Hintergrundwissen
ï€­ Output: paarweise Korrespondenzen zwischen Schemaelementen
(z.B. S1.e1 â€“S2.e2), ggf. ergÃ¤nzt um numerische Ã„hnlichkeit (zwischen 0
und 1) und Beziehungstyp: equal, is-a, part-of, related, â€¦

S1

Mapping:

Matching
S2

S1, S2
Instanzen

S1.e11, S2.e23
S1.e13, S2.e27
â€¦

Hintergrundwissen
(z.B. WÃ¶rterbÃ¼cher, Thesauri)

Abteilung Datenbanken

DATA WAREHOUSING

4-18

MATCH-BEISPIEL 1: RELATIONALE SCHEMAS

BookInfo

Books
ISBN char(15) key
Title varchar(100)
Author varchar(50)
MarkedPrice float

ID
char(15) key
AuthorID integer references AuthorInfo
BookTitle varchar(150)
ListPrice float
DiscountPrice float

AuthorInfo
AuthorID integer key
LastName varchar(25)
FirstName varchar(25)
Abteilung Datenbanken

DATA WAREHOUSING

4-19

MATCH-BEISPIEL 2: PRODUKTKATALOGE

Yahoo.de Shopping

Elektronik
TV & Video
DVD-Player
Beamer
Foto & Camcorder
Digitale Photographie
Digitalkameras

Abteilung Datenbanken

DATA WAREHOUSING

Amazon.de
Elektronik & Foto
Heimkino & Video
DVD-Player
Projektoren

Kamera & Foto
Digitalkameras

4-20

MATCH-BEISPIEL 3: N PRODUKT-SCHEMATA
(KAMERAS)

Abteilung Datenbanken

DATA WAREHOUSING

4-21

MAPPING EDITOR IN TALEND

Abteilung Datenbanken

DATA WAREHOUSING

4-22

AUTOMATISCHE MATCH-ANSÃ„TZE
ï€­ linguistische AnsÃ¤tze
ï€­ syntaktische Ã„hnlichkeit von Attribut/Konzeptnamen:
StringÃ¤hnlichkeit
ï€­ semantische Ã„hnlichkeit Ã¼ber WÃ¶rterbÃ¼cher (unter
BerÃ¼cksichtigung von Synonymen sowie Hypo/Hypernymen)
oder Embeddings aus vortrainierten Vokabularen
ï€­ Ã„hnlichkeit von Beschreibungen

ï€­ strukturelle Ã„hnlichkeit (bei â€tieferenâ€œ Schemata bzw.
Ontologien)
ï€­ Ã¤hnliche VorgÃ¤nger bzw. Nachfolger

ï€­ Ã¤hnliche Instanzdaten (z.B. Attributwerte)
ï€­ Ã„hnlichkeit zu bereits berechneten Korrespondenzen
ï€­ kombinierte AnsÃ¤tze
Abteilung Datenbanken

DATA WAREHOUSING

4-23

LINGUISTISCHES MATCHING
ï€­ einfachster Ansatz: Namensgleichheit
ï€­ syntaktische AnsÃ¤tze: approximate String-Ã„hnlichkeit von
Namen
ï€­ q-grams, Edit distance, TF/IDF ...

ï€­ semantische Ã„hnlichkeit durch Nutzung terminologischer
Beziehungen
ï€­ Synonyme: KFZ ~ Auto
ï€­ Hyponyme/Hyperonyme: Buch is-a Publikation, Artikel is-a
Publikation
ï€­ Nutzung von WÃ¶rterbÃ¼chern / Thesauri, z.B. WordNet

ï€­ Vorverarbeitung zur Behandlung kryptischer Namen,
AuflÃ¶sung von AbkÃ¼rzungen, etc.
ï€­ Tokenisierung von Namen: PO_OrderNum ï‚® {PO, Order, Num}
ï€­ Expansion von Akronymen, Kurzformen: PO ï‚® Purchase Order
Num ï‚® Number
Abteilung Datenbanken

DATA WAREHOUSING

4-24

Ã„HNLICHKEITSMAÃŸE FÃœR STRINGS: EDIT-DISTANCE
ï€­ Gegeben seien zwei Strings a und b
ï€­ Editabstand d(a,b) = Anzahl der Edit-Operationen, um a
in b zu konvertieren
ï€­ Edit-Operationen: EinfÃ¼gen, LÃ¶schen oder Ersetzen eines
Zeichens

ï€­ Ã„hnlichkeit ist normierter Editabstand
ï€­ auch: Levenshtein-Abstand

dist(a, b)
simedit (a, b) ï€½ 1 ï€­
max(| a |, | b |)

ï€­ Beispiel: â€Streetâ€œ vs. â€ShippingStreetâ€œ (LÃ¤nge 6 bzw. 14)
ï€­ ÃœberfÃ¼hrung erfordert EinfÃ¼gung von 8 Zeichen (S h i p p i n g)
ï€­ dist = 8

normierte Distanz: 8/14 = 0,57

ï€­ simedit = 1 - 8/14 = 0,43
Abteilung Datenbanken

DATA WAREHOUSING

4-25

Ã„HNLICHKEITSMAÃŸE FÃœR STRINGS: Q-GRAM
ï€­ Idee: Ãœberlappung bzgl. Substrings der LÃ¤nge q
ï€­ HÃ¤ufig q=3 (Trigramme) oder q=2 (Bigramme)
ï€­ optional Padding der Eingabestrings (q-1 FÃ¼llzeichen als
PrÃ¤ifx/Suffix)

ï€­ verschiedene Ã„hnlichkeitsmetriken fÃ¼r Ãœberlappung der
q-Gramme (set similarity), v.a. Dice- und JaccardÃ„hnlichkeit
ï€­ Q(a) = Menge der q-Gramme in String a

Abteilung Datenbanken

DATA WAREHOUSING

4-26

BEISPIEL Q-GRAM
â€Streetâ€œ vs. â€ShippingStreetâ€œ (Trigramm-Ã„hnlichkeiten)
ï€­ Ohne Padding:
Street:={Str, tre, ree, eet} (4)
ShippingStreet:={Shi, hip, ipp, ppi, pin, ing, ngS, gSt,
Str, tre, ree, eet} (12)
ï€­ Simdice =
Simjaccard =

ï€­ Mit Padding:
Street:={##S, #St, Str, tre, ree, eet, et#, t##} (8)
ShippingStreet:={##S, #Sh, Shi, hip, ipp, ppi, pin, ing,
ngS, gSt, Str, tre, ree, eet, et#, t##} (16)
ï€­ Simdice =
Simjaccard =

Abteilung Datenbanken

DATA WAREHOUSING

4-27

KOMBINATION VON MATCHERN

allgemeiner Match-Workflow (COMA, â€¦)
Input
schema
S1 s

Preprocessing

Matcher
Execution

S2

Combination
of matcher
results

Selection of
correspondences

Result
Mapping

(subworkflow)

Matcher-AusfÃ¼hrung:
Matcher

Matcher1
Matcher1

Matcher2

â€¦

Matcher2
Matcher3

Sequentielle Matcher

Abteilung Datenbanken

Parallele (unabhÃ¤ngige)
Matcher
DATA WAREHOUSING

Matcher1

Matcher
Matcher

Gemischte Strategie
4-28

COMA-ARCHITEKTUR (VLDB 2002)

ï® Auswahl der Match-Kandidaten

â€“ oft sinnvoll nur Best-Match pro Schemaelement zu betrachten
â€“ best match (S1.a1), S2.b1, kann anderen best-match in S1
haben, z.B. S1.a2
â†’ Problem der Stable Marriage

Abteilung Datenbanken

DATA WAREHOUSING

4-29

AUSWAHL VON 1:1 MATCHES
einfacher Ansatz (Coma) â€“
Symmetric Best Match (Max-Both)
ï€­ Best-Match S2.b1 zu S1.a1 wird nur berÃ¼cksichtigt,
wenn S1.a1 auch Best-Match von S2.b1 ist

Stable Marriage
ï€­ Mapping M (Menge an Matches zw. S1 und S2) ist stabil,
wenn es kein Paar (S1.ai, S2.bj) gibt, mit einer hÃ¶heren
Ã„hnlichkeit als die der aktuellen Matches in M sowohl
fÃ¼r S1.ai und S2.bj

ï€­ Maximal Weight Mapping
ï€­ 1:1 Mapping mit maximaler Summe der Ã„hnlichkeiten
ï€­ Mapping muss nicht stabil sein

Abteilung Datenbanken

DATA WAREHOUSING

4-30

MATCH-PROTOTYPEN

GOOGLE CLOUD DATA FUSION
ï® visuelle Definition von ETL-Pipelines mit UnterstÃ¼tzung

von Schema-Mapping
ï€­
ï€­
ï€­

automatische Schemaeerkennung
primÃ¤r manuelles Schema-Mapping, jedoch kÃ¶nnen
automatische AnsÃ¤tze integriert werden
automatische Erkennung von Attributpaaren mit identischer
Namen

https://cloud.google.com/application-integration/docs/data-mapping-overview

Abteilung Datenbanken

DATA WAREHOUSING

4-32

GOOGLE CLOUD DATA FUSION (2)

ï€­https://medium.com/gft-engineering/my-journey-with-google-cloud-data-fusion-dbe9e6f34924

Abteilung Datenbanken

DATA WAREHOUSING

4-33

4. ETL: DATENVORVERARBEITUNG UND INTEGRATION
ï€­ ETL-Ãœberblick
ï€­ Schemaintegration
ï€­ Bottom-Up- vs. Top-Down-Integration
ï€­ Semantische HeterogenitÃ¤t

ï€­ Schema Matching
ï€­ Verfahren
ï€­ Prototypen / Tools

ï€­ Data Cleaning
ï€­ Probleme
ï€­ Teilaufgaben

ï€­ Entity Matching (record linkage)
ï€­ Blocking, Matching, Clustering
ï€­ Systeme/Prototypen: MS SQL-Server, Dedoop, Famer
Abteilung Datenbanken

DATA WAREHOUSING

4-34

DATA CLEANING
ï€­ Datenanalyse / Profiling
ï€­ Entdeckung von Datenfehlern und -inkonsistenzen
ï€­ manuell bzw. Einsatz von Analyse-Tools

ï€­ Definition von Mapping-Regeln und TransformationsWorkflows
ï€­ Datentransformationen auf Schemaebene
ï€­ Cleaning-Schritte zur Behandlung von Instanzdaten

ï€­ Transformation
ï€­ regelmÃ¤ÃŸige AusfÃ¼hrung der geprÃ¼ften Transformationsschritte

ï€­ ggf. RÃ¼ckfluss korrigierter Daten in operative
Quellsysteme

Abteilung Datenbanken

DATA WAREHOUSING

4-35

PROBLEME BEZÃœGLICH DATENQUALITÃ„T
ï€­ Probleme auf Schema- und auf Instanzebene
ï€­ Probleme bezÃ¼glich einer oder mehrerer Datenquellen
(Single-Source vs. Multi-Source)
Data Quality Problems
Single-Source Problems

Multi-Source Problems

Schema Level

Schema Level

Instance Level

(Lack of integrity
constraints, poor
schema design)

(Data entry errors)

(Heterogeneous
data models and
schema designs)

- Uniqueness
- Referential integrity
â€¦

- Misspellings
- Redundancy/duplicates
- Contradictory values
â€¦

- Naming conflicts
- Structural conflicts
â€¦

Abteilung Datenbanken

DATA WAREHOUSING

Instance Level
(Overlapping,
contradicting and
inconsistent data)
- Inconsistent aggregating
- Inconsistent timing
â€¦

4-36

SINGLE-SOURCE PROBLEME
ï€­ Ursachen:
ï€­
ï€­
ï€­
ï€­

Fehlen von Schemata (z.B. bei Dateien) und von IntegritÃ¤ts-Constraints
Eingabefehler
unterschiedliche Ã„nderungsstÃ¤nde
UnvollstÃ¤ndigkeit â€¦

MultivalueFeld

Name

Misspelling

Adresse

Peter
Meier

Humboldtstr.
12, 04123
Liepzig
Schmitt, Lessingplatz 1,
Ingo
98321 Berlin
...
...

Phone

Erfahrung

Beruf

9999999999

A

DiplInformatiker

0309583014
...

M

Dipl.-Inf.

...

..

AttributwertabhÃ¤ngigkeit
Abteilung Datenbanken

Transposition

Fehlender
Wert

Kryptische
DATA WAREHOUSING Werte

Uneinheitliche
Bezeichnungen 4-37

DATENANALYSE / PROFILING
ï€­ Entdeckung von Fehlern / Verifikation korrekter Werte
ï€­ Ableitung von (wirklichen) Metadaten

ï€­ Berechnung der Statistiken zu Attributen auf Basis ihrer Instanzen
ï€­ Datentyp, LÃ¤nge, Maximum und Minimum, Null-, Default-Werte, KardinalitÃ¤t, ...
ï€­ Ermitteln von Wertebereichen, HÃ¤ufigkeiten und Mustern von Attributwerte

ï€­ Erkennung von AusreiÃŸern, funktionalen AbhÃ¤ngigkeiten
ï€­ SQL-Abfragen fÃ¼r Basis-Checks, z.B.
ï€­ SELECT Stadt,count(*) as Anzahl From Student Group By Stadt order by 2

Instanzwerte
Attribute Values

#occurences

IBM

3000

I.B.M.

360

Intel Bus Mach

International Business Machine
Abteilung Datenbanken

Pattern

(978) 555-1212 (nnn) nnn-nnnn

Identifizierte
Datenkategorie
Telefonnummer

213

036-55-1234
abc@web.de

nnn-nn-nnnn
aaa@aaa.aa

Social Security Number
Email-Addresse

36

12.03.2020

nn.nn.nnnn

Datum

DATA WAREHOUSING

4-38

BSP.: TALEND DATA PROFILING

https://help.qlik.com/talend/en-US/data-preparation-user-guide/Cloud/data-profiling-area

https://www.linux.com/news/explore-your-database-talend-open-profiler/

Abteilung Datenbanken

DATA WAREHOUSING

4-39

BEHANDLUNG VON SINGLE-SOURCE-PROBLEMEN
ï€­ Definition und EinfÃ¼hrung von StandardreprÃ¤sentationen
ï€­ einheitliches Format fÃ¼r Datums-/Zeit-Angaben
ï€­ einheitliche GroÃŸ/Kleinschreibungsform fÃ¼r Namen / String-Attribute
New Value
ï€­ einheitliche AbkÃ¼rzungen, Kodierungsschemas Legacy Value

ï€­ Bereitstellung von (Konversions-)Tabellen
zur expliziten Werteabbildung

IBM

IBM

I.B.M

IBM

Intel Bus Mach

IBM

...

...

ï€­ Extraktion von individuellen Werten aus Freiform-Attributen
ï€­ Parsing und Attribut-Splitting, z.B. Name â†’ Vorname / Nachname
ï€­ Reorganisierung der Wortreihenfolge

ï€­ Validierung / Korrektur mit Hintergrundwissen
ï€­ ÃœberprÃ¼fung/Spell checking mit WÃ¶rterbÃ¼chern, Datenbanken mit
Adressen, Produktbezeichnungen, Akronymen/AbkÃ¼rzungen, etc.
ï€­ Nutzung bekannter AttributabhÃ¤ngigkeiten zur Korrektur von fehlenden /
falschen Attributwerten, z.B. PLZ â†’ Ort
Abteilung Datenbanken

DATA WAREHOUSING

4-40

MULTI-SOURCE-PROBLEME
ï€­ unterschiedliche ReprÃ¤sentationen der Instanzdaten
ï€­ versch. Wertebereiche (z.B. Geschlecht = {0,1,2} vs. Sex = {u,m,w})
ï€­ verschiedene Einheiten (z.B. Verkauf in EUR vs. Verkauf in Tsd. EUR)
ï€­ verschiedene Genauigkeiten

ï€­ unterschiedliche Ã„nderungsstÃ¤nde und Aggregationsstufen
ï€­ Ã¼berlappende, widersprÃ¼chliche bzw. inkonsistente Daten

ï€­ Hauptproblem: Behandlung Ã¼berlappender Daten / Duplikate
ï€­ Beschreibung einer Instanz der realen Welt durch mehrere DatensÃ¤tze
unterschiedlicher Quellen
ï€­ oft nur teilweise Redundanz (einzelne Attribute, nur in Teilmenge der
Datenquellen)
ï€­ Behandlung durch Datenintegration
ï€­ Duplikaterkennung, Record Linkage, Entity Matching
ï€­ ggf. Fusion der sich entsprechenden Instanzen

Abteilung Datenbanken

DATA WAREHOUSING

4-41

MULTI-SOURCE-DATENINKONSISTENZEN: BEISPIEL
Source1: Customer

CID Name

Street

City

Sex

11

Kristen Smith

2 Hurley Pl South Fork, MN 48503

24

Christian Smith Hurley St 2 S Fork MN

0

1

Source2: Client

Cno LastName FirstName Gender Address
23 Harley St, Chicago
24
Smith
Christoph
M
IL, 60633-2394

493

Smith

Kris L.

Abteilung Datenbanken

F

2 Hurley Place, South
Fork MN, 48503-5998

DATA WAREHOUSING

Phone/Fax
333-222-6542
/ 333-2226599
444-555-6666

4-42

BEISPIEL (2)
CID

Name

Street

City

Sex

11

Kristen Smith

2 Hurley Pl

South Fork, MN 48503

0

24

Christian Smith

Hurley St 2

S Fork MN

1

No
1

LName
Smith

FName
Kristen L.

Gender
F

Street
2 Hurley
Place

City
South
Fork

State
MN

ZIP
485035998

2

Smith

Christian

M

2 Hurley
Place

South
Fork

MN

485035998

3

Smith

Christoph

M

23 Harley Chicago
Street

IL

606332394

Phone
444-5556666

Source1:
Customer

Fax

CID
11

Cno
493

24
333-2226542

333-2226599

24

Customers (Integrierte und bereinigte Daten)
Cno LastName FirstName Gender Address
23 Harley St, Chicago
24
Smith
Christoph
M
IL, 60633-2394

493

Smith

Abteilung Datenbanken

Kris L.

F

2 Hurley Place, South
Fork MN, 48503-5998

DATA WAREHOUSING

Phone/Fax
333-222-6542
/ 333-2226599
444-555-6666

Source2:
Client

4-43

SEMISTRUKTURIERTE DATENSÃ„TZE (KAMERAS)

Abteilung Datenbanken

DATA WAREHOUSING

4-44

4. ETL: DATENVORVERARBEITUNG UND INTEGRATION
ï€­ ETL-Ãœberblick
ï€­ Schemaintegration
ï€­ Bottom-Up- vs. Top-Down-Integration
ï€­ Semantische HeterogenitÃ¤t

ï€­ Schema Matching
ï€­ Verfahren
ï€­ Prototypen / Tools

ï€­ Data Cleaning
ï€­ Probleme
ï€­ Teilaufgaben

ï€­ Entity Matching (record linkage)
ï€­ Blocking, Matching, Clustering
ï€­ Systeme/Prototypen: MS SQL-Server, Dedoop, Famer
Abteilung Datenbanken

DATA WAREHOUSING

4-45

ENTITY MATCHING WORKFLOW
R
Blocking
S

Similarity
Computation
& Match
classification

Match
Paare

Entity
clustering

clusters of
matching
entities

ï€­ Eingabe: 1, 2 or n Datenquellen mit SÃ¤tzen
ï€­ Ausgabe:
ï€­ Paare von Satzmatches oder
ï€­ Menge von Entity-Clustern, in denen alle Matches zu einer EntitÃ¤t
gruppiert sind

ï€­ nâ‰¥2: saubere Datenquellen (ohne Duplikate) oder nicht
ï€­ fÃ¼r saubere Quellen kann hÃ¶chstens 1 Match pro EntitÃ¤t vorliegen:
maximale ClustergrÃ¶ÃŸe n

Abteilung Datenbanken

DATA WAREHOUSING

4-46

BLOCKING
ï€­ naives Matching: paarweiser Vergleich aller SÃ¤tze
ï€­ quadratische KomplexitÃ¤t: 1 Quelle mit n SÃ¤tzen: n (n-1)/ 2 Vergleiche
ï€­ bei 1 Million Vergleichen pro Sekunde dauert Matching fÃ¼r n=107 19 Monate

ï€­ skalierbare LÃ¶sungen erfordern Reduzierung der Vergleichszahl

ï€­ Blocking
ï€­ Gruppierung Ã¤hnlicher EntitÃ¤ten in Partitionen/BlÃ¶cke
Ã¼ber Attributwerte (z.B. Produkttyp)
ï€­ nur EntitÃ¤ten eines Blocks werden miteinander verglichen

ï€­ BlockgrÃ¶ÃŸe wichtig fÃ¼r Leistung und Match-QualitÃ¤t
ï€­ kleine BlÃ¶cke: wenige Vergleiche, evtl werden Matches aber nicht gefunden
ï€­ bei schmutzigen Daten ggf. mehrere Partitionierungen nÃ¶tig (multi-pass
blocking)

ï€­ Vielzahl an Blocking-Alternativen
ï€­ Standard-Blocking
ï€­ Sorted Neighborhood â€¦

Abteilung Datenbanken

DATA WAREHOUSING

4-47

STANDARD BLOCKING
ï€­ Partitionierung des Suchraums
Ã¼ber Blocking Key Values (BKV)
ï€­ BKV-Berechnung Ã¼ber Funktion auf
Attributwerten, z.B.
ï€­ Soundex (Nachname)
ï€­ Postleitzahl
ï€­ PrÃ¤fix(Produkthersteller, 4), â€¦

ï€­ Beispiel Soundex-Blocking:

8 SÃ¤tze: 28 Vergleiche ohne Blocking
P. Christen: A survey of indexing techniques for scalable record linkage and deduplication. IEEE TKDE, 2012

Abteilung Datenbanken

DATA WAREHOUSING

4-48

SORTED NEIGHBORHOOD
ï€­ meist fÃ¼r 1 Eingabequelle
ï€­ Sortierung der SÃ¤tze gemÃ¤ÃŸ Sort Key
ï€­ Matching nur auf benachbarten SÃ¤tzen (Fenster fester
LÃ¤nge w) â†’ lineare KomplexitÃ¤t
ï€­ Verbesserung: Vergleich des ersten Records oder des
letzten Records mit allen Records eines Fensters (letztes
bzw. erstes Fenster paarweise)

P. Christen: A survey of indexing techniques for scalable record linkage and deduplication. IEEE TKDE, 2012

Abteilung Datenbanken

DATA WAREHOUSING

4-49

METRIKEN FÃœR BLOCKING
ï€­ Blocking sollte mÃ¶glichst viele Vergleiche einsparen, ohne
Matches zu verlieren
ï€­ hohe Reduction Rate und sehr hohe Pairs Completeness
erforderlich

ï€­ Metrik Reduction Rate
ï€­ Reduction Rate RR = 1 âˆ’

ğ´ğ‘›ğ‘§ğ‘â„ğ‘™ ğ‘‘ğ‘’ğ‘Ÿ ğ‘‰ğ‘’ğ‘Ÿğ‘”ğ‘™ğ‘’ğ‘–ğ‘â„ğ‘’ ğ‘šğ‘–ğ‘¡ ğµğ‘™ğ‘œğ‘ğ‘˜ğ‘–ğ‘›ğ‘”
ğ´ğ‘›ğ‘§ğ‘â„ğ‘™ ğ‘‘ğ‘’ğ‘Ÿ ğ‘‰ğ‘’ğ‘Ÿğ‘”ğ‘™ğ‘’ğ‘–ğ‘â„ğ‘’ ğ‘œâ„ğ‘›ğ‘’ ğµğ‘™ğ‘œğ‘ğ‘˜ğ‘–ğ‘›ğ‘”

ï€­ Reduktion auf 1% der Vergleiche: RR=0,99

ï€­ Metrik Pairs Completeness
ï€­ ğ‘ƒğ‘irs Completeness (PC) =

ğ´ğ‘›ğ‘§ğ‘â„ğ‘™ ğ‘‘ğ‘’ğ‘Ÿ ğ‘€ğ‘ğ‘¡ğ‘â„âˆ’ğ‘ƒğ‘ğ‘ğ‘Ÿğ‘’,ğ‘‘ğ‘–ğ‘’ ğ‘£ğ‘’ğ‘Ÿğ‘”ğ‘™ğ‘–ğ‘â„ğ‘’ğ‘› ğ‘¤ğ‘’ğ‘Ÿğ‘‘ğ‘’ğ‘›
ğ´ğ‘›ğ‘§ğ‘â„ğ‘™ ğ‘‘ğ‘’ğ‘Ÿ ğ‘€ğ‘ğ‘¡ğ‘â„âˆ’ğ‘ƒğ‘ğ‘ğ‘Ÿğ‘’

ï€­ Erreichbarer Recall fÃ¼r Matching ist durch PC begrenzt

ï€­ Multi-Pass Blocking verbessert PC zu Lasten der RR
Abteilung Datenbanken

DATA WAREHOUSING

4-50

MATCHING
ï€­ kombinierte Nutzung mehrerer Ã„hnlichkeiten
ï€­ Ã„hnlichkeit verschiedener Attributwerte, z.B. gemÃ¤ÃŸ StringÃ¤hnlichkeit
(Edit-Distance, Q-gram etc,) oder numerische Ã„hnlichkeit
ï€­ kontext-basiertes Matching (z.B. Personen Ã¤hneln sich, wenn sie die
selben Eltern haben)

ï€­ Verwendung von manuell definierten Match-Regeln
ï€­ Personen-Match falls NamensÃ¤hnlichkeit > 80% + gleiches Geburtsdatum
ï€­ Publikations-Match: TitelÃ¤hnlichkeit > 85% + AutorÃ¤hnlichkeit > 50%
ï€­ durchschnittliche Ã„hnlichkeit mehrerer Attribute > 75% â€¦

ï€­ Nutzung Ã¼berwachter Klassifikationsverfahren (Machine Learning)
ï€­ z.B. mit EntscheidungsbÃ¤umen, SVM, neuronalen Netzen, etc.
ï€­ erfordern Trainingsdaten mit Matches/Non-Matches
ï€­ Nutzung von Embeddings (representation learning) kann Matchbarkeit
von Attributwerten verbessern

Abteilung Datenbanken

DATA WAREHOUSING

4-51

BEISPIEL ML-BASIERTES MATCHING
ï€­ Finden effektiver Match-Einstellungen ist schwierig
ï€­ Auswahl der Attribute, Matcher, Einstellungen

ï€­ gelerntes Klassifikationsmodell (z.B.
Entscheidungsbaum) bestimmt automatisch
ï€­ zu prÃ¼fende Attribute (z.B. Publikatonstitel, Autoren, â€¦)
ï€­ Ã„hnlichkeitsmetriken (EditDistance, Cosine, ..)
ï€­ Schwellwerte
Cosine(title) > 0.629

â†’Data Mining VL

-

+

Trigram(venue) > 0.197
-

+

EditDistance(year) > 0.25
Non-match

Abteilung Datenbanken

DATA WAREHOUSING

Trigram(authors) > 0.7

...

match

...

+
...

Entscheidungsbaum
4-52

METRIKEN FÃœR MATCHING

M

P

M = real Matches, P= predicted Matches

ENTITY CLUSTERING
Gruppierung der Matches einer EntitÃ¤t in Cluster

Cluster mit k SÃ¤tzen reprÃ¤sentiert k (k-1)/2 Match-Paare: kompaktere
ReprÃ¤sentation fÃ¼r k>2
fÃ¼r n duplikatfreie Quellen gilt k <= n
Fusionierung der Cluster-Mitglieder zur Datenintegration
Entity clustering

Input: paarweise Match-Kandidaten mit ihrer Ã„hnlichkeit (bilden sog. Similarity
Graph)
Ziel: Maximierung der Ã„hnlichkeit innerhalb der Cluster und Minimierung der
Ã„hnlichkeit zwischen Cluster

Basisansatz: Connected Component (transitive HÃ¼lle) Ã¼ber
paarweise Match-Links
kann leicht zu groÃŸen Clustern mit unÃ¤hnlichen SÃ¤tzen fÃ¼hren

MS SQL-SERVER: MATCH-OPERATOREN
ï€­ Bestandteil von SQL-Server
Integration Services (SSIS)*
ï€­ ermÃ¶glicht Definition komplexer ETL-Workflows
ï€­ zahlreiche Operatoren

ï€­ Fuzzy Lookup
ï€­ â€œFuzzy Matchâ€ zwischen Eingaberelation und sauberen
SÃ¤tzen einer Referenztabelle: inkrementelles Matching
ï€­ Parameter: Schwellwerte bzgl. String-Ã„hnlichkeit
(Edit Distance) sowie Gewichte zur Kombination
von Ã„hnlichkeiten

ï€­ Fuzzy Grouping
ï€­ Gruppierung Ã¤hnlicher SÃ¤tze (potenzielle
Duplikate) innerhalb einer Tabelle Ã¼ber
String-Matching (Edit Distance)

* http://msdn.microsoft.com/en-us/library/ms345128.aspx
Abteilung Datenbanken

DATA WAREHOUSING

4-55

MATCH-PROTOTYPEN
ï€­ DEDOOP (U Leipzig, 2012)
ï€­ paralleles paarweises Entity Matching auf Hadoop
ï€­ UnterstÃ¼tzung fÃ¼r Blocking, lernbasiertes Matching und Lastbalancierung

ï€­ FAMER (U Leipzig, seit 2017)
ï€­ paralleles Matching fÃ¼r viele (>2) Datenquellen
ï€­ UnterstÃ¼tzung fÃ¼r Entity Clustering

ï€­ Magellan
ï€­ Open-Source Python Framework mit UnterstÃ¼tzung von Blocking und
Matching
ï€­ UnterstÃ¼tzung fÃ¼r ML-Matching, inkl. Deep Learning
ï€­ visuelle OberflÃ¤che und gut dokumentierte API

ï€­
Abteilung Datenbanken

DATA WAREHOUSING

4-56

DUPLIKATE IN WEBDATEN: BEISPIEL

Abteilung Datenbanken

DATA WAREHOUSING

4-57

WORKFLOW PRODUCT MATCHING

ï‚ Pre-processing

Product Code
Extraction

Product
Offers

Manufacturer
Cleaning

Automatic
Classification

ï‚‚ Training
Training Data
Selection

Matcher
Application

Classifier

ï‚ƒ Application
Blocking
(Manufacturer
+ Category)

Classifier
Learning

Matcher
Application

Classification

Product
Match Result
Koepcke, Thor, Thomas, Rahm: Tailoring entity resolution for matching product offers. Proc. EDBT, 2012
Abteilung Datenbanken

DATA WAREHOUSING

4-58

FAMER
ï® FAst Multi-source Entity Resolution system

â€“ Annahme: duplikatfreie Eingabequellen

https://dbs.uni-leipzig.de/research/projects/object_matching/famer
Abteilung Datenbanken

DATA WAREHOUSING

4-59

FAMER-BEISPIEL
Eingabedaten aus
4 Quellen

FAMERAnwendung

Abteilung Datenbanken

DATA WAREHOUSING

4-60

INKREMENTELLES
MATCHING/CLUSTERING MIT FAMER*
ï€­ Integration neuer EntitÃ¤ten/Datenquellen
ï€­ Matching neuer EntitÃ¤ten mit existierendem Similarity
Graph
ï€­ Zuweisung eines neues Entity zu Ã¤hnlichstem Cluster bzw.
neues Cluster

ï€­ optionale Anpassung (Reparatur) bisheriger Cluster

*A. Saeedi, E. Peukert, E. Rahm: Incremental Multi-source Entity Resolution for Knowledge Graph Completion. Proc. ESWC 2020
Abteilung Datenbanken

DATA WAREHOUSING

4-61

ZUSAMMENFASSUNG (1)
ï€­ ETL als komplexer, aufwÃ¤ndiger Integrationsprozess
ï€­ Schema- und Datenintegration / Data Cleaning
ï€­ zahlreiche Schema- und Datenkonflikte
ï€­ Unterscheidung quell-lokaler und -Ã¼bergreifender Datenkonflikte
ï€­ Data Profiling erster Schritt zur Datenbereinigung

ï€­ Fokussierung auf Data Warehouse-spezifisches
Zielschema erleichtert Schemaintegration
ï€­ Top-Down-Schemaintegration
ï€­ keine vollstÃ¤ndige Integration aller Quell-Schemata erforderlich

ï€­ wichtiges Teilproblem: Schema-Matching
ï€­ Bestimmung semantischer Korrespondenzen
ï€­ Nutzung und Kombination mehrerer Matcher, u.a. linguistischer, struktureller
und instanzbasierter Verfahren

Abteilung Datenbanken

DATA WAREHOUSING

4-62

ZUSAMMENFASSUNG (2)
ï€­ zentrales Problem: Duplikat-Identifikation und â€“
Behandlung (Entity Matching)
ï€­ hohe Effizienzanforderungen (-> Nutzung von BlockingVerfahren und ggf. Parallelisierung)
ï€­ kombinierte Nutzung mehrerer Match-Verfahren
ï€­ trainingsbasierte KlassifikationsansÃ¤tze erleichtern Konfiguration
des Match-Schrittes
ï€­ Entity Clustering gruppiert alle Matches (Varianten) pro Entity

ï€­ inkrementelles Matching / Clustering erforderlich
ï€­ Abgleich neuer mit bereits existierenden DatensÃ¤tzen
ï€­ UnterstÃ¼tzung u.a. in FAMER-Prototyp

ï€­ zahlreiche Tools / Produkte mit stark unterschiedlicher
FunktionalitÃ¤t
ï€­ zunehmend ML-UnterstÃ¼tzung fÃ¼r Entity-Matching
Abteilung Datenbanken

DATA WAREHOUSING

4-63

